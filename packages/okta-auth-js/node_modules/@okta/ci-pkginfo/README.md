CI-PKGINFO
============

Gets package properties and okta metadata that is created during the NPM publish flow.

This module should be installed in all internal NPM modules that integrate with Bacon - it is one of the scripts that needs to be run prior to publishing an NPM module.

## Using ci-update-package

### Setup

In your module's root app folder, run:
```bash
# Find latest version
[npm/my-module]$ npm view @okta/ci-pkginfo versions

# Install latest version
[npm/my-module]$ npm install @okta/ci-pkginfo@<latest_version> --save-dev
```

For Bacon, you should add this run script to `package.json`:
```javascript
// package.json
"scripts": {
  "ci-pkginfo:dataload": "ci-pkginfo -t dataload"
}
```

## Examples
### Example 1: Getting internal full version of a package from command line.
```
> npm run ci-pkginfo -- -t fullversion
1.1.1-201603151046-d117b77
```
Prints to stdout the fullversion of the package including git commit id for reference.

### Example 2: Getting internal full version of a package As API.
```js
var pkg = require('./package.json'),
    pkgInfo = require('ci-pkginfo')(pkg);

console.log(pkgInfo.fullversion());
```

## API
``` js
var pkg = require('./package.json'),
    pkgInfo = require('ci-pkginfo')(pkg);
```

### `pkgInfo.fullversion()` &rarr; &lt;String&gt;
Returns the internal full version defined as:
`<semver>-<datetime>-<short git sha>`
where datetime is equivalent to cmd output:
`date +"%Y%m%d%H%M"`

### `pkgInfo.dataload()` &rarr; &lt;String&gt;
Returns the full url to be used when posting a build property to our internal storage manager.

### `pkgInfo.pkgsemver()` &rarr; &lt;String&gt;
Returns the package semver.

### `pkgInfo.pkgname()` &rarr; &lt;String&gt;
Returns the package name.

## Environment integration
Package getpkginfo relies on certain variables pre-set to default values but that can be overridden by the enviroment.

### `REGISTRY_URLBASE` &rarr; &lt;String&gt;
Set by default to value `https://artifacts.aue1d.saasure.com/artifactory`
It sets the base url to be used for the registry. For example: `<REGISTRY_URLBASE>/api/storage/npm-okta/`
